var JOYSTICK_DIV=null;function __init_joystick_div(){var t=(JOYSTICK_DIV=document.createElement("div")).style;t.background="rgba(255,255,255,0)",t.position="absolute",window.innerWidth>700&&(t.top="200px"),window.innerWidth<700&&(t.top="1800px"),t.bottom="0px",t.left="0px",t.right="0px",t.margin="0px",t.padding="0px",t.borderWidth="0px",t.position="absolute",t.overflow="hidden",t.zIndex="10000",document.body.appendChild(JOYSTICK_DIV)}export var JoyStick=function(t){this.radius=t.radius||50,this.inner_radius=t.inner_radius||this.radius/2,this.x=t.x||0,this.y=t.y||0,this.mouse_support=t.mouse_support||!0,void 0===t.visible&&(t.visible=!0),t.visible&&this.__create_fullscreen_div()};JoyStick.prototype.left=!1,JoyStick.prototype.right=!1,JoyStick.prototype.up=!1,JoyStick.prototype.down=!1,JoyStick.prototype.__is_up=function(t,i){return!(window.innerWidth>700&&i>=200||window.innerWidth<700&&i>=1800||Math.abs(t)>2*Math.abs(i))},JoyStick.prototype.__is_down=function(t,i){return!(window.innerWidth>700&&i<=200||window.innerWidth<700&&i<=1800||Math.abs(t)>2*Math.abs(i))},JoyStick.prototype.__is_left=function(t,i){return!(t>=0||Math.abs(i)>2*Math.abs(t))},JoyStick.prototype.__is_right=function(t,i){return!(t<=0||Math.abs(i)>2*Math.abs(t))},JoyStick.prototype.__create_fullscreen_div=function(){var t;null===JOYSTICK_DIV&&__init_joystick_div(),this.div=JOYSTICK_DIV,this.base=document.createElement("span"),(t=this.base.style).width=2*this.radius+"px",t.height=2*this.radius+"px",t.position="absolute",t.top=this.y-this.radius+"px",t.left=this.x-this.radius+"px",t.borderRadius="50%",t.borderColor="red",t.borderWidth="1px",t.borderStyle="solid",this.div.appendChild(this.base),this.control=document.createElement("span"),(t=this.control.style).width=2*this.inner_radius+"px",t.height=2*this.inner_radius+"px",t.position="absolute",t.top=this.y-this.inner_radius+"px",t.left=this.x-this.inner_radius+"px",t.borderRadius="50%",t.backgroundColor="red",t.borderWidth="1px",t.borderColor="red",t.borderStyle="solid",this.div.appendChild(this.control);var i=this;function o(t){if(window.innerWidth>700){var o=t.changedTouches?t.changedTouches[0]:t;if(i.mouse_support&&0===o.buttons)return;i.control.style.left=o.clientX-i.inner_radius+"px",i.control.style.top=o.clientY-i.inner_radius-200+"px";var s=o.clientX-i.x,e=o.clientY-i.y;i.up=i.__is_up(s,e),i.down=i.__is_down(s,e),i.left=i.__is_left(s,e),i.right=i.__is_right(s,e)}window.innerWidth<700&&(o=t.changedTouches?t.changedTouches[0]:t,i.control.style.left=o.clientX-i.inner_radius+"px",i.control.style.top=o.clientY-i.inner_radius-200+"px",s=o.clientX-i.x,e=o.clientY-i.y,i.up=i.__is_up(s,e),i.down=i.__is_down(s,e),i.left=i.__is_left(s,e),i.right=i.__is_right(s,e))}function s(){i.left=!1,i.right=!1,i.up=!1,i.down=!1,i.control.style.top=i.y-i.inner_radius+"px",i.control.style.left=i.x-i.inner_radius+"px"}this.bind("touchmove",o),this.bind("touchstart",o),this.bind("touchend",s),this.mouse_support&&(this.bind("mousedown",o),this.bind("mousemove",o),this.bind("mouseup",s))},JoyStick.prototype.bind=function(t,i){this.base.addEventListener(t,i),this.control.addEventListener(t,i)};var JoyStickButton=function(t){this.radius=t.radius||50,this.x=t.x||0,this.y=t.y||0,this.text=t.text||"",this.mouse_support=t.mouse_support||!1,null===JOYSTICK_DIV&&__init_joystick_div(),this.base=document.createElement("span"),this.base.innerHTML=this.text;var i=this.base.style;i.width=2*this.radius+"px",i.height=2*this.radius+"px",i.position="absolute",i.top=this.y-this.radius+"px",i.left=this.x-this.radius+"px",i.borderRadius="50%",i.backgroundColor="rgba(255,255,255,0.1)",i.borderWidth="1px",i.borderColor="rgba(255,255,255,0.8)",i.borderStyle="solid",JOYSTICK_DIV.appendChild(this.base),t.func&&(this.mouse_support&&this.bind("mousedown",t.func),this.bind("touchstart",t.func));var o=this;function s(){i.backgroundColor="rgba(255,255,255,0.3)"}function e(){i.backgroundColor="rgba(255,255,255,0.1)"}o.bind("touchstart",s),o.bind("touchend",e),this.mouse_support&&(o.bind("mousedown",s),o.bind("mouseup",e))};JoyStickButton.prototype.bind=function(t,i){this.base.addEventListener(t,i)};